# [III과목]

생성일: 2024년 7월 22일 오후 11:31

## 01장 ) R 기초와 데이터 마트

### R 데이터 구조

1. 벡터
- 데이터 타입이 같은 여러 데이터를 하나의 행으로 저장하는 1차원 데이터 구조.
- ‘연결하다’라는 의미의 ‘concatenate’의 c를 써서 데이터를 묶을 수 있다.
- c 안에 콤마를 구분자로 써서 성분을 직접 입력하거나 콜론(:)을 사용해 시작값과 끝값 지정.

```r
> v4 <- c(3, TRUE, FALSE)
> v4
[1] 3 1 0
> v5 <- c('a', 1, TRUE)
> v5
[1] "a" "1" "TRUE"
> v1 <- c(1 : 6)
> v1
[1] 1 2 3 4 5 6
```

2. 행렬
- 2차원 구조를 가진 벡터.
- 벡터의 성질을 가지므로 행렬에 저장된 모든 데이터는 같은 타입이어야함
- 그렇지 못할 경우 자동으로 타입 변환 수행
- matrix를 사용하여 행렬을 만들 경우 `nrow`를 사용하여 행의 수를 결정하거나 `ncol` 을 사용해 열의 수 결정

```r
> m1 <- matrix( c(1:6), nrow = 2)
> m1
		[,1] [,2] [,3]
[1,]  1    3    5
[2,]  2    4    6
>m2 <- matrix( c(1:6), ncol = 2)
>m2
    [,1] [,2]
[1,]  1    4
[2,]  2    5
[3,]  3    6  
```

- matrix를 사용해 행렬을 만들 경우 행렬의 값들이 열로 저장
- `byrow` 옵션에 T를 지정하면 값들이 행으로 저장

```r
> m3 <- matrix ( c(1:6), nrow = 2, byrow = T)
> m3
     [,1] [,2] [,3]
 [1,]  1    2    3
 [2,]  4    5    6
```

- 벡터에 차원을 주는 방법으로도 행렬 생성 가능
- `dim` 함수를 사용해 행의 개수와 열의 개수 지정하여 행렬로 변환
- `dim` 함수는 벡터를 행렬로 변환할 뿐만 아니라 주어진 행렬이 몇 개의 행과 몇 개의 열로 구성되어 있는지 행렬의 크기를 나타내기도 함

```r
> v1 <- c( 1 : 6)
> v1
[1] 1 2 3 4 5 6
> dim(v1) <- c(2, 3)
> v1
		[,1] [,2] [,3]
[1,]  1    3    5
[2,]  2    4    6
```

3. 배열
- 3차원 이상의 구조를 갖는 벡터를 배열이라고 함
- 배열 또한 벡터의 성질을 가지므로 배열에 포함된 데이터는 모두 같은 타입
- `array` 를 사용해 배열을 만들 수 있으나 몇 차원의 구조를 갖는지 `dim` 옵션에 명시해야됨
- 그렇지 않으면 1차원 벡터가 생성됨

```r
> a1 <-array( c (1: 12), dim = c(2, 3, 2))
> a1
,  ,  1
      [,1] [,2] [,3]
  [1,]  1    3    5
  [2,]  2    4    6
,  ,  2
      [,1] [,2] [,3]
  [1,]  7    9    11
  [2,]  8   10    12
```

- 행렬과 마찬가지로 `dim` 함수를 사용해 벡터에 차원을 지정해 배열 생성 가능

```r
> a2 <- c(1:12)
> a2
[1] 1 2 3 4 5 6 7 8 9 10 11 12
> dim (a2) <- c(2, 3, 2)
> a2
,  ,  1
      [,1] [,2] [,3]
  [1,]  1    3    5
  [2,]  2    4    6
,  ,  2
      [,1] [,2] [,3]
  [1,]  7    9    11
  [2,]  8   10    12
```

4. 리스트
- 데이터타입, 데이터 구조에 상관없이 사용자가 원하는 모든 것을 저장 가능한 자료구조

5. 데이터프레임
- 데이터 분석을 위한 2차원 구조를 갖는 관계형 데이터 구조로 R에서 가장 많이 활용됨
- 행렬과 같은 모양을 갖지만 여러 개의 벡터로 구성되어 있기 때문에 각 열은 서로 다른 타입의 데이터를 가질 수 있음

```r
> v1 <- c ( 1, 2, 3)
> v2 <- c( 'a', 'b', 'c')
> df1 <- data.frame(v1, v2)
> df1
  v1 v2
1  1  a
2  2  b
3  3  c
```

<aside>
💡 파이썬, 자바, C 등과 다르게 R의 벡터는 시작 인덱스 값을 1로 갖는다

</aside>

### R 내장 함수

1. 기본함수

| 함수 | 내용 |
| --- | --- |
| help() 또는 ? | 함수들의 도움말 볼 수 있음 |
| paste() | 문자열 이어붙임 |
| seq() | 시작값, 끝값, 간격으로 수열 생성 |
| rep() | 주어진 데이터를 일정 횟수만큼 반복 |
| rm() | 대입 연산자에 의해 생성된 변수 삭제 |
| ls() | 현재 생성된 변수들의 리스트 보여줌 |
| print() | 값을 콘솔창에 출력 |

2. 통계함수

| 함수 | 내용 |
| --- | --- |
| sum | 합 |
| mean | 평균 |
| median | 중앙값 |
| var | 분산 |
| sd | 표준편차 |
| max | 최댓값 |
| min | 최솟값 |
| range | 최댓값과 최솟값 |
| summary | 요약값 |
| skewness | 왜도 |
| kurtosis | 첨도 |

### R 데이터핸들링

1. 데이터 이름 변경
- 행렬, 배열, 데이터프레임과 같이 2차원 이상의 데이터구조는 `colnames`  와 `rownames` 함수를 사용해 행과 열의 이름을 알수 있으며, 이름 지정 가능

2. 데이터 추출
- R 이 보유한 여러 데이터구조 모두 인덱싱을 지원함
- 따라서 대괄호 [, ] 를 사용하여 원하는 위치의 데이터 얻기 가능
- 행과 열의 이름으로도 데이터 얻기 가능
- 데이터프레임에서는 $ 기호를 사용하여 원하는 열의 데이터 구할 수 있으며 $와 [ ] 혼용 가능

3. 데이터 결합
- `rbind` : 데이터를 행으로 결합
- `cbind` : 데이터를 열로 결합
- 행렬과 행렬, 데이터프레임과 데이터프레임의 경우 행의 수 혹은 열의 수가 같을 경우 결합 가능
- 벡터와 벡터의 결합에서는 재사용 규칙으로 인해 부족한 데이터를 앞에서부터 다시 재활용하여 사용하며 오류와함께 결과 반환

### 제어문

1. 반복문
- for와 while 두 가지 종류

```r
> for( i in 1:3) {
+ print( i )
+ }

[1] 1
[1] 2
[1] 3

> data <- c( "a" , "b", "c")
> for ( i in data) {
print( i )
}
[1] "a"
[1] "b"
[1] "c"
```

2. 조건문
- 참과 거짓에 따라 특정 코드가 수행될지 아닐지 결정

3. 사용자 정의 함수

```r
> comparedTo5 <- function (number) {
> if (number < 5)
print(' number는 5보다 작다')
}
else if (number > 5) {
print ('number는 5보다 크다')
}
else {
print(' number는 5와 같다')
}
}
> comparedTo5( 10 )
[1] "number는 5보다 크다"
```

4. 주석
- R에서 실행되지 않는 문장으로, #으로 표시

### 통계분석에 자주 사용되는 R 함수

1. 숫자 연산

| 함수 | 내용 |
| --- | --- |
| sqrt | 제곱근 |
| abs | 절댓값 |
| exp | 자연상수e의 제곱수 |
| log | 밑이 자연상수인 로그 |
| log10 | 밑이 10인 로그 |
| pi | 원주율 |
| round | 반올림 |
| ceiling | 올림 |
| floor | 내림 |

2. 문자연산

| 함수 | 내용 |
| --- | --- |
| tolower | 주어진 문자열을 소문자로 전환 |
| toupper | 주어진 문자열을 대문자로 전환 |
| nchar | 주어진 문자열의 길이 구함 |
| substr | 문자열의 일부분 추출 |
| strsplit | 문자열을 구분자로 나누어 쪼갬 |
| grepl | 문자열에 주어진 문자가 있는지 확인 |
| gsub | 문자열의 일부분을 다른 문자로 대체 |

3. 벡터연산

| 함수 | 내용 |
| --- | --- |
| length | 주어진 벡터의 길이  |
| paste | 주어진 벡터를 구분자 기준으로 결합 |
| cov | 두 수치 벡터의 공분산  |
| cor | 두 수치 벡터의 상관계수  |
| table | 데이터의 개수 |
| order | 벡터의 순서 |

4. 행렬연산

| 함수 | 내용 |
| --- | --- |
| t | 전치행렬을 구한다 |
| diag | 대각행렬을 구한다 |
| %*% | 두 행렬을 곱한다 |

5. 데이터 탐색

| 함수 | 내용 |
| --- | --- |
| head | 데이터의 앞 일부분을 보여준다 |
| tail | 데이터의 뒤 일부분을 보여준다 |
| quantile | 수치 벡터의 4분위수를 보여준다 |

6. 데이터 전처리

| 함수 | 내용 |
| --- | --- |
| subset | 데이터에서 조건식에 맞는 데이터 추출 |
| merge | 두 데이터를 특정 공통된 열을 기준으로 병합 |
| apply | 데이터에 열 별로 주어진 함수 적용 |

7. 정규분포(기본값은 표준 정규 분포로 mean = 0, sd = 1)

| 함수 | 내용 |
| --- | --- |
| dnorm | 정규 분포의 주어진 값에서 함수 값을 구함 |
| rnorm | 정규 분포에서 주어진 개수만큼 표본 추출 |
| pnorm | 정규 분포에서 주어진 값보다 작을 확률 값 구함 |
| qnorm | 정규 분포에서 주어진 넓이 값을 갖는 x값 구함 |

8. 표본추출

| 함수 | 내용 |
| --- | --- |
| runis | 균일 분포에서 주어진 개수만큼 표본 추출 |
| sample | 주어진 데이터에서 주어진 개수만큼 표본 추출 |

9. 날짜

| 함수 | 내용 |
| --- | --- |
| Sys.Date | 연,월,일 출력 |
| Sys.time | 연,월,일,시간 출력 |
| as.Date | 주어진 데이터를 날짜 형식으로 변환 |
| format | 원하는 날짜 형식으로 변경 |
| as.POSIXct | 타임스탬프를 날짜 및 시간으로 변환 |

10. 산점도 

| 함수 | 내용 |
| --- | --- |
| plot | 주어진 데이터의 산점도를 그림 |
| abline | 산점도에 추가 직선을 그림 |

11. 파일 읽기쓰기

| 함수 | 내용 |
| --- | --- |
| read.csv | CSV 파일 불러옴 |
| write.csv | 주어진 데이터를 CSV 파일로 저장 |
| saveRDS | 분석모델 및 R 파일 저장 |
| readRDS | 분석모델 및 R 파일 불러옴 |

## 데이터마트

- 데이터 분석에 앞서 분석 목적에 맞춰 데이터를 수집, 변형하는 과정 필요
- 데이터 마트란 데이터 웨어하우스로부터 특정 사용자가 관심을 갖는 데이터들을 주제별, 부서별로 추출하여 모은 비교적 작은 규모의 데이터 웨어하우스
- 분석 목적별, 주제별, 부서별로 데이터를 수집하고 변형하여 한 곳에 모으는 작업을 데이터 마트 개발이라 부름
- 효율적인 데이터 마트 개발을 위해 R에서 제공하는 reshape, sqldf, plyr 등의 다양한 패키지 활용 가능

### 데이터 전처리
